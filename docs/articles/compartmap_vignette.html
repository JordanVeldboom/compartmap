<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A/B compartment inference from ATAC-seq and methylation arrays with compartmap • compartmap</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A/B compartment inference from ATAC-seq and methylation arrays with compartmap">
<meta property="og:description" content="compartmap">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">compartmap</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.65.87</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/compartmap_vignette.html">A/B compartment inference from ATAC-seq and methylation arrays with compartmap</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/JordanVeldboom/compartmap/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="compartmap_vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A/B compartment inference from ATAC-seq and methylation arrays with compartmap</h1>
                        <h4 class="author">Ben Johnson</h4>
            
            <h4 class="date">26 June 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/JordanVeldboom/compartmap/blob/master/vignettes/compartmap_vignette.Rmd"><code>vignettes/compartmap_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>compartmap_vignette.Rmd</code></div>

    </div>

    
    
<div id="compartmap-shrunken-ab-compartment-inference-from-atac-seq-and-methylation-arrays" class="section level1">
<h1 class="hasAnchor">
<a href="#compartmap-shrunken-ab-compartment-inference-from-atac-seq-and-methylation-arrays" class="anchor"></a>Compartmap: Shrunken A/B compartment inference from ATAC-seq and methylation arrays</h1>
<p>Compartmap extends methods to perform A/B compartment inference from (sc)ATAC-seq and methylation arrays originally proposed by Fortin and Hansen 2015, Genome Biology (<a href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-015-0741-y" class="uri">https://genomebiology.biomedcentral.com/articles/10.1186/s13059-015-0741-y</a>). Originally, Fortin and Hansen demonstrated that chromatin conformation could be inferred from (sc)ATAC-seq, bisulfite sequencing, DNase-seq and methylation arrays, similar to the results provided by HiC. Thus, in addition to the base information provided by the aforementioned assays, chromatin state could also be inferred. However, these data were restricted to group level A/B compartment inference.</p>
<p>Here, we propose a method to infer sample-level chromatin state, thus enabling (un)supervised clustering of samples/cells based on A/B compartments. To accomplish this, we employ a shrinkage estimator towards a global or targeted mean, using either chromsome or genome-wide information from ATAC-seq and methylation arrays (e.g. Illumina 450k or EPIC arrays). The output from compartmap can then be embedded and visualized using your favorite clustering approach, such as UMAP/tSNE.</p>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<div id="input" class="section level3">
<h3 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h3>
<p>The expected input for compartmap is either a RangedSummarizedExperiment object or GenomicRatioSet object. These can be built using packages like <a href="https://github.com/biobenkj/ATACseeker">ATACseeker</a> or <a href="https://www.bioconductor.org/packages/devel/bioc/html/sesame.html">SeSAMe</a>.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r">
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">compartmap</span>))
<span class="co">## Warning: package 'foreach' was built under R version 4.0.2</span>
<span class="co">## Warning: package 'iterators' was built under R version 4.0.2</span>
<span class="co">## Warning: package 'ggplot2' was built under R version 4.0.2</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">GenomicRanges</span>))
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Homo.sapiens</span>))

<span class="co">#Load in some example methylation array data</span>
<span class="co">#This data is derived from https://f1000research.com/articles/5-1281/v3</span>
<span class="co">#data(meth_array_450k_chr14, package = "compartmap")</span>

<span class="co">#Load in some example ATAC-seq data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">bulkATAC_raw_filtered_chr14</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"compartmap"</span>)</pre></body></html></div>
</div>
<div id="processing-data" class="section level3">
<h3 class="hasAnchor">
<a href="#processing-data" class="anchor"></a>Processing data</h3>
<p>To process the data (filter and perform compartment inference) a wrapper function is used for all data types.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">
<span class="co">#Process chr14 of the example array data</span>
<span class="co">#Note: running this in parallel is memory hungry!</span>

<span class="co">#array_compartments &lt;- getCompartments(array.data.chr14, type = "array", parallel = FALSE, chrs = "chr14")</span>

<span class="co">#Process chr14 of the example ATAC-seq data</span>
<span class="no">atac_compartments</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/compartmap/man/getCompartments.html">getCompartments</a></span>(<span class="no">filtered.data.chr14</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"atac"</span>, <span class="kw">parallel</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">chrs</span> <span class="kw">=</span> <span class="st">"chr14"</span>)
<span class="co">## Mapping chromosome "chr14"</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient11_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient11_Romi_Day14...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient11_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient11_Vori_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient11_Vori_Day14...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient11_Vori_Day21...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient11_Vori_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1366_Romi_Day14...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1366_Romi_Day28...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1366_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1409_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1409_Romi_Day28...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1424_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1424_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1424_Vori_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1424_Vori_Day15...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1424_Vori_Day21...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1424_Vori_Day28...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1424_Vori_Day35...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1424_Vori_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1461_Romi_Day0Post1Hour...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1461_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1461_Romi_Day28...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1461_Romi_Day35...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1461_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1482_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1482_Romi_Day14...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient1482_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient20_Vori_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient20_Vori_Day14...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient20_Vori_Day21...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient20_Vori_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient5_Vori_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient5_Vori_Day14...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient5_Vori_Day21...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkCTCL_Patient5_Vori_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkStage3_Patient30_Vori_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkStage3_Patient30_Vori_Day14...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkStage3_Patient30_Vori_Day21...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for BulkStage3_Patient30_Vori_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient11_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient11_Romi_Day14A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient11_Romi_Day14B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient1366_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient1424_Vori_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient1424_Vori_Day14...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient1424_Vori_Day21...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient1424_Vori_Day28...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient1424_Vori_Day35...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient1424_Vori_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient20_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient39_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient59_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient59_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient62_Romi_Day0A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Host_Patient62_Romi_Day0B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Naive_T_cellA...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Naive_T_cellB...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Naive_T_cellC...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Naive_T_cellD...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Th17_cellA...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Th17_cellB...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Th17_cellC...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Th1_cellA...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Th1_cellB...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Th1_cellC...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Th2_cellA...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Th2_cellB...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Th2_cellC...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Treg_cellA...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for human_Treg_cellB...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient11_Romi_Day0A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient11_Romi_Day0B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient11_Romi_Day14A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient11_Romi_Day14B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient11_Romi_Day7A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient11_Romi_Day7B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient1366_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient1424_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient1424_Romi_Day14...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient1424_Romi_Day21...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient1424_Romi_Day28...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient1424_Romi_Day35...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient1424_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient20_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient39_Romi_Day0A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient39_Romi_Day0B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient39_Romi_Day7A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient39_Romi_Day7B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient59_Romi_Day7A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient59_Romi_Day7B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient60_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient60_Romi_Day7...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient61_Romi_Day0...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient62_Romi_Day0A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Leukemic_Patient62_Romi_Day0B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor10_Day224A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor10_Day224B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor10_Day38...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day1A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day1B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day224A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day224B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day2A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day2B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day37A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day37B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day38A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day38B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor1_Day39...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor2_Day224A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor2_Day224B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor31_Day192A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor31_Day192B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor32_Day224A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor32_Day224B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor33_Day224A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor33_Day224B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor3_Day37...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor4_Day107A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor4_Day107B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor4_Day224A...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor4_Day224B...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor4_Day37...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor7_Day38...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span>
<span class="co">## Computing shrunken compartment eigenscores for Normal_Donor9_Day38...</span>
<span class="co">## 108 bins created...</span>
<span class="co">## Calculating correlations...</span>
<span class="co">## Done...</span>
<span class="co">## Calculating eigenvectors...</span>
<span class="co">## Smoothing with a k of 2 for 2 iterations...</span>
<span class="co">## Done smoothing...</span></pre></body></html></div>
</div>
<div id="ouput-and-post-processing" class="section level3">
<h3 class="hasAnchor">
<a href="#ouput-and-post-processing" class="anchor"></a>Ouput and post-processing</h3>
<p>Once the data have been processed, the object returned is a matrix of sample-level A/B compartments (samples as columns and compartments as rows). These are normalized to chromosome length and each compartment corresponds to a non-empty bin (based on the desired resolution - 1 Mb is the default). From here, the data can be visualized using something like plotAB for individual samples or your favorite clustering method. Additionally, these can be overlaid in something like IGV to see where compartments are changing between samples/conditions.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">
<span class="co">#Plotting individual samples</span>
<span class="co">#For 7 samples</span>
<span class="co">#Adjust ylim as necessary</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>))
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">7</span>,<span class="fl">1</span>))
<span class="fu"><a href="../reference/plotAB.html">plotAB</a></span>(<span class="no">array_compartments</span>[,<span class="fl">1</span>], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="kw">unitarize</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="../reference/plotAB.html">plotAB</a></span>(<span class="no">array_compartments</span>[,<span class="fl">2</span>], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="kw">unitarize</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">top.col</span> <span class="kw">=</span> <span class="st">"goldenrod"</span>)
<span class="fu"><a href="../reference/plotAB.html">plotAB</a></span>(<span class="no">array_compartments</span>[,<span class="fl">3</span>], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="kw">unitarize</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">top.col</span> <span class="kw">=</span> <span class="st">"darkblue"</span>)
<span class="fu"><a href="../reference/plotAB.html">plotAB</a></span>(<span class="no">array_compartments</span>[,<span class="fl">4</span>], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="kw">unitarize</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">top.col</span> <span class="kw">=</span> <span class="st">"red"</span>)
<span class="fu"><a href="../reference/plotAB.html">plotAB</a></span>(<span class="no">array_compartments</span>[,<span class="fl">5</span>], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="kw">unitarize</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">top.col</span> <span class="kw">=</span> <span class="st">"black"</span>)
<span class="fu"><a href="../reference/plotAB.html">plotAB</a></span>(<span class="no">array_compartments</span>[,<span class="fl">6</span>], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="kw">unitarize</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">top.col</span> <span class="kw">=</span> <span class="st">"cyan"</span>)
<span class="fu"><a href="../reference/plotAB.html">plotAB</a></span>(<span class="no">array_compartments</span>[,<span class="fl">7</span>], <span class="kw">ylim</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="kw">unitarize</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">top.col</span> <span class="kw">=</span> <span class="st">"seagreen"</span>)

<span class="co">#Embed with UMAP for unsupervised clustering</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">uwot</span>))
<span class="no">embed_compartments</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/uwot/man/umap.html">umap</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="no">array_compartments</span>), <span class="kw">n_neighbors</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">metric</span> <span class="kw">=</span> <span class="st">"manhattan"</span>, <span class="kw">n_components</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">n_trees</span> <span class="kw">=</span> <span class="fl">100</span>)

<span class="co">#Visualize embedding</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">vizier</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">plotly</span>)
<span class="fu">embed_plotly</span>(<span class="no">embed_compartments</span>, <span class="kw">tooltip</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(<span class="no">embed_compartments</span>), <span class="kw">show_legend</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Benjamin Johnson, Tim Triche, Kasper Hansen, Jean-Philippe Fortin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
